# RCE exploit Gitlab [CVE-2021-22204](https://nvd.nist.gov/vuln/detail/CVE-2021-22204)

Simple RCE exploit targeting Gitlab < 13.9.6

[CVE-2021-22204](https://nvd.nist.gov/vuln/detail/CVE-2021-22204)

## Environment
Tested on Ubuntu 18.04, targeting localhost/self-host, without SSL/TLS.

## Setup
RCE (*Remote Code Execution*) described on [HackerOne](https://hackerone.com/reports/1125425)

The vulnerability allows the execution of *Ruby* code.

### Dependencies
Install BeautifulSoup :
```sh
pip3 install bs4
```

## Usage
```sh
python3 ./exploit-gitlab.py <server> <payload> <cookies>
```
| Parameter | Description |
|---|---|
| server | Domain name or IP Address (e.g 127.0.0.1, localhost) |
| payload | Ruby file to execute |
| cookie | Session cookie to used. |
*You need to initiate a session to get its associated cookies.*

## Author
Dimitri S.